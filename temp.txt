// URL /canonico/1/sincroniza/1

function getIdDado(kafkaTopic, canonico) {
	const nomeId = canonico.nomeId
	return kafkaTopic[nomeId];
}

function sincroniza(idCanonico, kafkaTopic) {
	const canonico = buscaCanonicoExistente(idCanonico)
	
	const idDado = getIdDado(kafkaTopic, canonico)
	
	const dadoCarregadoAtual = DynamoDBServiceDoCanonico().get(idDado)
	
	if (canonico.tipoSincronizacao === CUSTOM) {
		sincronizaCanonico(canonico, dadoCarregadoAtual, kafkaTopic)
	} else {
		loadCanonico(canonico.nome, dadoCarregadoAtual.dadosParametros)
	}
}

// URL /canonico/1/reprocessamento/1

function reprocessa(idCanonico, idDado, payloadReprocessamento) {
	const canonico = buscaCanonicoExistente(idCanonico)
	
	const dadoCarregadoAtual = DynamoDBServiceDoCanonico().get(idDado)
	
	if (payloadReprocessamento.tipoReprocessamento === CUSTOM) {
		reprocessamentoCanonico(canonico, dadoCarregadoAtual, payloadReprocessamento)
	} else {
		loadCanonico(canonico.nome, dadoCarregadoAtual.dadosParametros)
	}
}